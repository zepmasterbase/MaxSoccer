<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Max Soccer ⚽ | Login & Register</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Orbitron',sans-serif}
body{
  background:radial-gradient(circle at top,#1b1f4b,#070a1f);
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* MODAL */
.modal{
  background:rgba(0,0,0,.75);
  padding:3rem 2rem;
  border-radius:25px;
  backdrop-filter:blur(20px);
  box-shadow:0 0 55px rgba(255,0,0,.75);
  max-width:450px;
  width:100%;
  text-align:center;
  animation:fadeIn .6s ease;
}

@keyframes fadeIn{
  from{opacity:0;transform:translateY(-25px)}
  to{opacity:1;transform:translateY(0)}
}

.modal h1{
  color:#ff0000;
  text-shadow:0 0 20px rgba(255,0,0,.8);
  margin-bottom:.5rem;
}
.modal p{
  opacity:.85;
  margin-bottom:2rem;
}

/* TABS */
.tabs{
  display:flex;
  justify-content:center;
  margin-bottom:2rem;
}
.tab{
  padding:.8rem 2rem;
  cursor:pointer;
  border-bottom:2px solid transparent;
  transition:.3s;
}
.tab.active{
  color:#ff4d4d;
  border-bottom:2px solid #ff4d4d;
}

/* FORMS */
form{display:none;flex-direction:column;gap:1rem}
form.active{display:flex}

input, select{
  padding:1rem;
  border-radius:15px;
  border:none;
  outline:none;
  background:rgba(255,255,255,.06);
  color:#fff;
  font-size:1rem;
  transition:.3s;
}
input:focus, select:focus{
  box-shadow:0 0 25px rgba(255,0,0,.6);
  background:rgba(255,0,0,.1);
}

button{
  padding:1rem;
  border:none;
  border-radius:50px;
  background:linear-gradient(135deg,#ff0000,#ff4d4d);
  color:#fff;
  font-size:1.1rem;
  font-weight:700;
  cursor:pointer;
  transition:.3s;
}
button:hover{
  transform:scale(1.05);
  box-shadow:0 0 60px rgba(255,0,0,.8);
}

footer{
  margin-top:2rem;
  font-size:.85rem;
  opacity:.6;
}
</style>
</head>

<body>

<div class="modal">
  <h1>Max Soccer ⚽</h1>
  <p>Login or Register to access VIP content or Ambassador dashboard</p>

  <div class="tabs">
    <div class="tab active" data-tab="login">Login</div>
    <div class="tab" data-tab="register">Register</div>
  </div>

  <!-- LOGIN -->
  <form id="loginForm" class="active">
    <input type="email" id="loginEmail" placeholder="Email" required>
    <input type="password" id="loginPassword" placeholder="Password" required>
    <button type="submit">Login</button>
  </form>

  <!-- REGISTER -->
  <form id="registerForm">
    <input type="text" id="username" placeholder="Username" required>
    <input type="email" id="registerEmail" placeholder="Email" required>
    <input type="password" id="registerPassword" placeholder="Password" required>
    <select id="role">
      <option value="user">VIP Subscriber</option>
      <option value="ambassador">Ambassador</option>
    </select>
    <button type="submit">Create Account</button>
  </form>

  <footer>© 2026 Max Soccer ⚽</footer>
</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

const supabase = createClient(
  "https://iotraxlicmdyybtgmkwm.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlvdHJheGxpY21keXlidGdta3dtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzNTA1OTAsImV4cCI6MjA4MzkyNjU5MH0.f69kiDeO7h0RPwRhSzINFoiVRRFjDB_CYk4nbhl2zBA"
);

/* TAB SWITCH */
document.querySelectorAll(".tab").forEach(tab=>{
  tab.onclick=()=>{
    document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
    document.querySelectorAll("form").forEach(f=>f.classList.remove("active"));
    tab.classList.add("active");
    document.getElementById(tab.dataset.tab+"Form").classList.add("active");
  }
});

/* REGISTER */
registerForm.onsubmit = async e =>{
  e.preventDefault();

  const username = document.getElementById("username").value;
  const email = registerEmail.value;
  const password = registerPassword.value;
  const role = document.getElementById("role").value;

  const { data, error } = await supabase.auth.signUp({ email, password });
  if(error) return alert(error.message);

  const promoCode = role === "ambassador"
    ? `MAX-${username.toUpperCase()}-${Math.floor(1000+Math.random()*9000)}`
    : null;

  await supabase.from("users").insert({
    id: data.user.id,
    username,
    email,
    role,
    promo_code: promoCode,
    wallet_balance: 0,
    total_referrals: 0
  });

  window.location.href = role === "ambassador" ? "ambassador.html" : "vip.html";
};

/* LOGIN */
loginForm.onsubmit = async e =>{
  e.preventDefault();

  const { data, error } = await supabase.auth.signInWithPassword({
    email: loginEmail.value,
    password: loginPassword.value
  });
  if(error) return alert(error.message);

  const { data: profile } = await supabase
    .from("users")
    .select("role")
    .eq("id", data.user.id)
    .single();

  window.location.href =
    profile.role === "ambassador" ? "ambassador.html" : "vip.html";
};
</script>

</body>
</html>