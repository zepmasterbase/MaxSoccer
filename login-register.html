<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Max Soccer ⚽ | Login & Register</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Orbitron',sans-serif;}
body{
  background:radial-gradient(circle at top,#1b1f4b,#070a1f);
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* MODAL */
.modal{
  background:rgba(0,0,0,.7);
  padding:3rem 2rem;
  border-radius:25px;
  backdrop-filter:blur(15px);
  box-shadow:0 0 50px rgba(255,0,0,.7);
  max-width:450px;
  width:100%;
  text-align:center;
  position:relative;
  animation:fadeIn 0.6s ease;
}
@keyframes fadeIn{
  0%{opacity:0;transform:translateY(-30px);}
  100%{opacity:1;transform:translateY(0);}
}

.modal h1{
  color:#ff0000;
  text-shadow:0 0 15px rgba(255,0,0,.7);
  margin-bottom:1rem;
}
.modal p{
  opacity:.85;
  margin-bottom:2rem;
}
.modal .tabs{
  display:flex;
  justify-content:center;
  margin-bottom:2rem;
}
.modal .tab{
  padding:.8rem 2rem;
  cursor:pointer;
  border-bottom:2px solid transparent;
  transition:.3s;
}
.modal .tab.active{
  border-bottom:2px solid #ff4d4d;
  color:#ff4d4d;
}

/* FORM */
form{
  display:none;
  flex-direction:column;
  gap:1rem;
}
form.active{display:flex;}

input, select{
  padding:1rem;
  border-radius:15px;
  border:none;
  outline:none;
  background:rgba(255,255,255,.05);
  color:#fff;
  font-size:1rem;
  backdrop-filter:blur(5px);
  transition:.3s;
}
input:focus, select:focus{
  background:rgba(255,0,0,.1);
  box-shadow:0 0 20px rgba(255,0,0,.5);
}

button{
  padding:1rem;
  border:none;
  border-radius:50px;
  background:linear-gradient(135deg,#ff0000,#ff4d4d);
  color:#fff;
  font-weight:700;
  cursor:pointer;
  font-size:1.1rem;
  transition:.3s;
}
button:hover{
  transform:scale(1.05);
  box-shadow:0 0 50px rgba(255,0,0,.7);
}

/* FOOTER */
footer{
  text-align:center;
  padding-top:2rem;
  opacity:.6;
  font-size:.85rem;
}

</style>
</head>
<body>

<div class="modal">
  <h1>Max Soccer ⚽</h1>
  <p>Login or Register to access VIP content or Ambassador dashboard</p>

  <div class="tabs">
    <div class="tab active" data-tab="login">Login</div>
    <div class="tab" data-tab="register">Register</div>
  </div>

  <!-- LOGIN FORM -->
  <form id="loginForm" class="active">
    <input type="email" id="loginEmail" placeholder="Email" required>
    <input type="password" id="loginPassword" placeholder="Password" required>
    <select id="loginRole">
      <option value="user">VIP Subscriber</option>
      <option value="ambassador">Ambassador</option>
    </select>
    <button type="submit">Login</button>
  </form>

  <!-- REGISTER FORM -->
  <form id="registerForm">
    <input type="text" id="registerUsername" placeholder="Username" required>
    <input type="email" id="registerEmail" placeholder="Email" required>
    <input type="password" id="registerPassword" placeholder="Password" required>
    <select id="registerRole">
      <option value="user">VIP Subscriber</option>
      <option value="ambassador">Ambassador</option>
    </select>
    <button type="submit">Register</button>
  </form>

  <footer>© 2026 Max Soccer ⚽</footer>
</div>

<script type="module">
// ===== SUPABASE INIT =====
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

// Your live Supabase config
const supabaseUrl = 'https://iotraxlicmdyybtgmkwm.supabase.co'
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlvdHJheGxpY21keXlidGdta3dtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzNTA1OTAsImV4cCI6MjA4MzkyNjU5MH0.f69kiDeO7h0RPwRhSzINFoiVRRFjDB_CYk4nbhl2zBA'
const supabase = createClient(supabaseUrl, supabaseKey)

// ===== TABS =====
const tabs = document.querySelectorAll('.tab')
const loginForm = document.getElementById('loginForm')
const registerForm = document.getElementById('registerForm')

tabs.forEach(tab=>{
  tab.addEventListener('click', ()=>{
    tabs.forEach(t=>t.classList.remove('active'))
    tab.classList.add('active')
    if(tab.dataset.tab==='login'){
      loginForm.classList.add('active')
      registerForm.classList.remove('active')
    }else{
      registerForm.classList.add('active')
      loginForm.classList.remove('active')
    }
  })
})

// ===== REGISTER =====
registerForm.addEventListener('submit', async (e)=>{
  e.preventDefault()
  const username = document.getElementById('registerUsername').value
  const email = document.getElementById('registerEmail').value
  const password = document.getElementById('registerPassword').value
  const role = document.getElementById('registerRole').value

  const { data, error } = await supabase.auth.signUp({ email, password })
  if(error){ alert(error.message); return }

  // Insert user profile with role & promo code
  const promoCode = `MAX-${username.toUpperCase()}-${Math.floor(1000 + Math.random()*9000)}`
  await supabase.from('users').insert({ id: data.user.id, username, email, role, promo_code: promoCode, wallet_balance:0 })

  alert('Registration successful! Promo code generated: '+promoCode)
  window.location.href = role==='ambassador' ? 'ambassador.html' : 'vip.html'
})

// ===== LOGIN =====
loginForm.addEventListener('submit', async (e)=>{
  e.preventDefault()
  const email = document.getElementById('loginEmail').value
  const password = document.getElementById('loginPassword').value

  const { data, error } = await supabase.auth.signInWithPassword({ email, password })
  if(error){ alert(error.message); return }

  // Fetch role
  const { data: profile } = await supabase.from('users').select('role').eq('id', data.user.id).single()
  if(!profile){ alert('Profile not found'); return }

  window.location.href = profile.role==='ambassador' ? 'ambassador.html' : 'vip.html'
})
</script>

</body>
</html>